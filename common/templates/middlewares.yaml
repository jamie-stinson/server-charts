{{- if .Values.ingress.traefik.enabled }}
{{- range .Values.ingress.traefik.hosts }}
  - apiVersion: traefik.containo.us/v1alpha1
    kind: Middleware
    metadata:
      name: {{ printf "%s-%s-middleware" $.Release.Name .name }}
    spec:
      headers:
        {{- if .middlewares.cors.enabled }}
        accessControlAllowMethods:
          {{- range .middlewares.cors.accessControlAllowMethods }}
          - "{{ . }}"
          {{- end }}
        accessControlAllowHeaders:
          {{- range .middlewares.cors.accessControlAllowHeaders }}
          - "{{ . }}"
          {{- end }}
        accessControlAllowOriginList:
          {{- range .middlewares.cors.accessControlAllowOriginList }}
          - "{{ . }}"
          {{- end }}
        accessControlMaxAge: {{ .middlewares.cors.accessControlMaxAge }}
        addVaryHeader: {{ .middlewares.cors.addVaryHeader }}
        {{- end }}
        {{- if .middlewares.customRequestHeaders }}
        customRequestHeaders:
          {{- range $key, $value := .middlewares.customRequestHeaders }}
          {{ $key }}: "{{ $value }}"
          {{- end }}
        {{- end }}
        {{- if .middlewares.customResponseHeaders }}
        customResponseHeaders:
          {{- range $key, $value := .middlewares.customResponseHeaders }}
          {{ $key }}: "{{ $value }}"
          {{- end }}
        {{- end }}
{{- end }}
{{- end }}
